

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Plotting Brain Surfaces &mdash; Neurocat 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=d45e8c67"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=ccdb6887"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Surface Transformation" href="transfer.html" />
    <link rel="prev" title="User guide" href="../usage.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Neurocat
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation and Setup</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../usage.html">User guide</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Plotting Brain Surfaces</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#medial-wall-problem">Medial Wall Problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cortical-surface-visualization">Cortical Surface Visualization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#subcortical-visualization">Subcortical Visualization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="transfer.html">Surface Transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="io.html">Surface File IO</a></li>
<li class="toctree-l2"><a class="reference internal" href="color.html">Color Map manipulation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Neurocat</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../usage.html">User guide</a></li>
      <li class="breadcrumb-item active">Plotting Brain Surfaces</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/user_guide/plotting.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="plotting-brain-surfaces">
<span id="usage-plotting"></span><h1>Plotting Brain Surfaces<a class="headerlink" href="#plotting-brain-surfaces" title="Link to this heading"></a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>This module provides a streamlined interface for visualizing brain surface data. It includes three core functions tailored for different anatomical scopes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">draw_cortex</span></code> – cortical data (fsLR surfaces, Schaefer/Glasser atlases)</p>
<blockquote>
<div><ul class="simple">
<li><p>Data could be both in vertex space or parcellated space, the fucntion will map automatically</p></li>
<li><p>Medial wall will be automatically restored if the data lack</p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">draw_subcortex_tian</span></code> – subcortical data (<a class="reference external" href="https://www.nature.com/articles/s41593-020-00711-6">Tian 2020 atlas</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">draw_sftian</span></code> – combined cortical + subcortical visualization</p></li>
</ul>
</section>
<section id="medial-wall-problem">
<h2>Medial Wall Problem<a class="headerlink" href="#medial-wall-problem" title="Link to this heading"></a></h2>
<p>Vertex-wise datasets often exclude the medial wall (the non-cortical connection between hemispheres). In the standard fsLR-32k space, a full surface mesh contains 64,984 vertices, but the real data is frequently restricted to the 54,984 cortical vertices that exclude the medial wall.</p>
<p>The data overlayed on the geometry file should have the same point size. Given the geometry file includes medial wall, your data should always include the medial wall with zero value or np.nan.</p>
<p>The <cite>draw_cortex</cite> function automatically handles this discrepancy. If your input data omits the medial wall, the function will detect and pad the data appropriately, allowing you to focus on visualization without manual preprocessing.</p>
</section>
<section id="cortical-surface-visualization">
<h2>Cortical Surface Visualization<a class="headerlink" href="#cortical-surface-visualization" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">draw_cortex</span></code> is used to render the cerebral cortex.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">neurocat.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">draw_cortex</span> <span class="k">as</span> <span class="n">dc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">neurocat</span><span class="w"> </span><span class="kn">import</span> <span class="n">color</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span><span class="p">(</span><span class="n">t1t2</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">color</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">myelin</span><span class="p">(),</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="p">(</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">1.6</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;T1/T2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/plotting_vertex.png"><img alt="../_images/plotting_vertex.png" class="align-center" src="../_images/plotting_vertex.png" style="width: 300.0px; height: 177.15px;" />
</a>
<p>If your data is defined/calculated in parcellated (atlas) space, you do not need to manually map it to surface vertices. <code class="docutils literal notranslate"><span class="pre">draw_cortex</span></code> performs this conversion internally.</p>
<p>Common parcellations such as the Schaefer and Glasser atlases are supported internally; the function automatically identifies the atlas from the length of the input vector.</p>
<p>The following example computes the principal functional connectivity gradient using the Schaefer 400-parcel atlas and visualizes the result directly on the cortical surface.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span><span class="p">(</span><span class="n">fc_principal</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">color</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">gradient</span><span class="p">(),</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;gradient&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/plotting_parc.png"><img alt="../_images/plotting_parc.png" class="align-center" src="../_images/plotting_parc.png" style="width: 300.0px; height: 177.15px;" />
</a>
<p>Refer to the API of <a class="reference internal" href="../generated/neurocat.plotting.html#neurocat.plotting.draw_cortex" title="neurocat.plotting.draw_cortex"><code class="xref py py-func docutils literal notranslate"><span class="pre">neurocat.plotting.draw_cortex()</span></code></a> for all possible keywords.</p>
</section>
<section id="subcortical-visualization">
<h2>Subcortical Visualization<a class="headerlink" href="#subcortical-visualization" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">draw_sftian</span></code> enables simultaneous visualization of both cortical and subcortical structures. For cortical data, input should be parcellated using the Schaefer 400 or 1000 atlas; subcortical data should correspond to the Tian 2020 atlas. The combined input vector should therefore have a length of either 432 (Schaefer 400 + Tian) or 1030 (Schaefer 1000 + Tian).</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>The fsLR version of the Schaefer 1000 atlas is missing two labels due to the transformation from fsaverage6 to fsLR. For more details, see <a class="reference external" href="https://github.com/ThomasYeoLab/CBIG/issues/43">issue1</a>, <a class="reference external" href="https://github.com/ThomasYeoLab/CBIG/issues/10">issue2</a>, and <a class="reference external" href="https://github.com/netneurolab/neuromaps/issues/66">issue3</a>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Subcortical mesh files are provided by courtesy of <a class="reference external" href="mailto:sidhant&#46;chopra&#37;&#52;&#48;yale&#46;edu">Sidhant Chopra</a> from their <a class="reference external" href="https://github.com/sidchop/NetworkDeformationModels">work</a>. The meshes were reconstructed and smoothed using pyvista.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">neurocat.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">draw_cortex</span> <span class="k">as</span> <span class="n">dc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">neurocat</span><span class="w"> </span><span class="kn">import</span> <span class="n">color</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span><span class="p">(</span><span class="n">t1t2</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">color</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">myelin</span><span class="p">(),</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="p">(</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">1.6</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;T1/T2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="p">)</span>
</pre></div>
</div>
<p>Refer to the API of <a class="reference internal" href="../generated/neurocat.plotting.html#neurocat.plotting.draw_sftian" title="neurocat.plotting.draw_sftian"><code class="xref py py-func docutils literal notranslate"><span class="pre">neurocat.plotting.draw_sftian()</span></code></a> for all possible keywords.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../usage.html" class="btn btn-neutral float-left" title="User guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="transfer.html" class="btn btn-neutral float-right" title="Surface Transformation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Saiwen Yu.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>